# 实战练习

> 💪 **综合应用所学知识**
> 
> ⏱️ 预计学习时间：**4-6小时**

---

## 🎯 本章目标

学完前面的章节后，现在是时候综合应用了：

- ✅ 应用 Solidity 语法知识（3.1-3.5）
- ✅ 应用代码规范与最佳实践（3.6）
- ✅ 应用以太坊标准（3.7）
- ✅ 培养完整的开发思维

---

## 📚 练习列表

### 01-简单存储合约 (0.5h)
**难度**: ⭐

- 实现简单的数据存储
- 应用命名规范
- 添加 NatSpec 注释
- 实现访问控制

**学习重点**：
- 基础语法
- 代码规范
- 注释规范

---

### 02-计数器合约 (0.5h)
**难度**: ⭐

- 实现递增/递减计数器
- 事件触发
- 错误处理
- Gas 优化意识

**学习重点**：
- 状态变量管理
- 事件规范
- 基础优化

---

### 03-投票合约 (1h)
**难度**: ⭐⭐

- 实现提案和投票
- 权重管理
- 防止重复投票
- 检查-生效-交互模式

**学习重点**：
- 映射使用
- 安全编码模式
- 业务逻辑实现

---

### 04-众筹合约 (1h)
**难度**: ⭐⭐

- 实现众筹逻辑
- 目标金额检查
- 退款机制
- 拉取支付模式

**学习重点**：
- payable 函数
- ETH 转账
- 安全支付模式

---

### 05-拍卖合约 (1.5h)
**难度**: ⭐⭐⭐

- 实现拍卖逻辑
- 出价管理
- 时间控制
- 状态机模式

**学习重点**：
- 复杂状态管理
- 时间锁
- 状态机模式

---

### 06-多签钱包合约 (1.5h)
**难度**: ⭐⭐⭐

- 实现多签逻辑
- 提案和确认
- **（选做）集成 EIP-712 签名**
- **（选做）实现 EIP-1271**

**学习重点**：
- 复杂权限管理
- 签名验证
- **应用 EIP-712（3.7 学习的）**
- **应用 EIP-1271（3.7 学习的）**

---

## 🆕 额外挑战练习

### 07-ERC-20 代币合约（选做）
**难度**: ⭐⭐⭐

基于学到的 EIP-20 标准，实现完整的 ERC-20 代币：

```solidity
// 基础要求
- [ ] 实现 EIP-20 所有必需接口
- [ ] 实现 EIP-165 接口检测
- [ ] 添加 name, symbol, decimals

// 进阶要求（应用 3.7 学到的标准！）
- [ ] 集成 EIP-712
- [ ] 实现 EIP-2612 Permit
- [ ] 添加完整的 NatSpec 注释
- [ ] 应用所有代码规范
```

**学习重点**：
- **综合应用 EIP-20, EIP-165, EIP-712, EIP-2612**
- 完整的代币实现
- 为学习 OpenZeppelin 做准备

---

### 08-带签名验证的投票合约（选做）
**难度**: ⭐⭐⭐

基于练习 03，增强为支持链下签名的版本：

```solidity
// 应用 EIP-712 实现链下投票
- [ ] 用户链下签名投票意图
- [ ] 任何人可以提交签名
- [ ] 验证签名有效性
- [ ] 节省 Gas（投票者不需要支付 Gas）
```

**学习重点**：
- **应用 EIP-712 结构化签名**
- 元交易模式
- 实际场景应用

---

## 💡 学习建议

### 循序渐进

```
第一轮：基础实现
├─ 01-简单存储合约
├─ 02-计数器合约
└─ 完成基本功能

第二轮：应用规范（3.6）
├─ 重构：应用命名规范
├─ 添加：完整的 NatSpec 注释
├─ 优化：改进代码结构
└─ 配置：使用 Solhint 检查

第三轮：进阶合约
├─ 03-投票合约
├─ 04-众筹合约
├─ 05-拍卖合约
└─ 应用安全模式

第四轮：高级合约
├─ 06-多签钱包合约
├─ （选做）应用 EIP-712
├─ （选做）应用 EIP-1271
└─ 综合所有知识

第五轮：挑战练习（选做）
├─ 07-ERC-20 代币（应用多个 EIP）
├─ 08-带签名的投票（应用 EIP-712）
└─ 准备学习 OpenZeppelin！
```

---

## 🎯 每个练习的标准流程

### 1. 需求分析
- 理解业务逻辑
- 确定状态变量
- 设计接口

### 2. 编码实现
```solidity
// ✅ 正确的合约结构（应用 3.6）
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

/// @title 合约标题
/// @author 你的名字
/// @notice 给用户看的说明
/// @dev 给开发者看的说明
contract MyContract {
    // 1. 类型声明
    // 2. 状态变量
    // 3. 事件
    // 4. 错误
    // 5. 修饰符
    // 6. 函数（按顺序：constructor, receive, fallback, external, public, internal, private）
}
```

### 3. 应用规范（3.6）
- [ ] 命名符合规范
- [ ] 添加 NatSpec 注释
- [ ] 函数顺序正确
- [ ] 安全模式应用
- [ ] Gas 优化意识

### 4. （选做）应用标准（3.7）
- [ ] 如果涉及代币，应用 EIP-20
- [ ] 如果涉及签名，应用 EIP-712
- [ ] 如果涉及接口检测，应用 EIP-165

### 5. 测试
```javascript
// 使用 Hardhat 或 Foundry
describe("MyContract", function() {
  it("应该正确执行基本功能", async function() {
    // 测试代码
  });
  
  it("应该正确处理边界情况", async function() {
    // 测试代码
  });
  
  it("应该正确处理错误情况", async function() {
    // 测试代码
  });
});
```

### 6. 代码审查
- [ ] 使用 Solhint 检查
- [ ] 自查安全清单
- [ ] 检查 Gas 优化机会

---

## ✅ 学习检查清单

### 基础练习 ✅
- [ ] 完成 01-简单存储合约
- [ ] 完成 02-计数器合约
- [ ] 代码符合规范

### 进阶练习 ✅
- [ ] 完成 03-投票合约
- [ ] 完成 04-众筹合约
- [ ] 完成 05-拍卖合约
- [ ] 应用安全模式

### 高级练习 ✅
- [ ] 完成 06-多签钱包合约
- [ ] 应用代码规范
- [ ] （选做）应用 EIP 标准

### 挑战练习 ✅（选做）
- [ ] 完成 ERC-20 代币实现
- [ ] 集成 EIP-712 + EIP-2612
- [ ] 完成带签名的投票合约
- [ ] 能理解 OpenZeppelin 的设计

---

## 🚀 完成后

恭喜！你已经：

- ✅ 掌握了 Solidity 完整语法
- ✅ 理解了代码规范与最佳实践
- ✅ 理解了以太坊标准（EIP/ERC）
- ✅ 具备了完整的开发思维
- ✅ 准备好学习专业的智能合约库了！

**下一步**：

```
Week 9 开始：
├─ 04-开发工具篇
│   └─ 掌握 Hardhat/Foundry
│
├─ 05-智能合约库深入篇 ⭐
│   ├─ 现在你能理解 OpenZeppelin 的设计了！
│   ├─ 因为你懂代码规范（3.6）
│   ├─ 因为你懂 EIP 标准（3.7）
│   └─ 你会发现很多库都基于你学过的 EIP
│
└─ 06-代币标准篇
    ├─ 深入 ERC-20
    ├─ 深入 ERC-721
    └─ 你已经在 3.7 学过基础了！
```

---

## 📚 参考资源

### 开发工具
- [Remix IDE](https://remix.ethereum.org/)
- [Hardhat](https://hardhat.org/)
- [Foundry](https://book.getfoundry.sh/)

### 代码规范（3.6）
- [Solidity Style Guide](https://docs.soliditylang.org/en/latest/style-guide.html)
- [NatSpec 规范](https://docs.soliditylang.org/en/latest/natspec-format.html)

### 标准参考（3.7）
- [EIP-20 (ERC-20)](https://eips.ethereum.org/EIPS/eip-20)
- [EIP-712](https://eips.ethereum.org/EIPS/eip-712)
- [EIP-2612 (Permit)](https://eips.ethereum.org/EIPS/eip-2612)

### 最佳实践
- [OpenZeppelin Contracts](https://docs.openzeppelin.com/contracts/)
- [Consensys Best Practices](https://consensys.github.io/smart-contract-best-practices/)

---

**Let's build something amazing! 🚀💪**
