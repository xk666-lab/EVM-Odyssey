# ç»•è¿‡åˆçº¦é•¿åº¦æ£€æŸ¥ (Bypassing Contract Size Check)

> ğŸ’¡ **æ ¸å¿ƒè¦ç‚¹**
> - `extcodesize` åœ¨åˆçº¦æ„é€ æœŸé—´è¿”å› 0
> - ä¸èƒ½ä»…ç”¨ä»£ç é•¿åº¦åˆ¤æ–­ EOA
> - `tx.origin == msg.sender` ç ´åå¯ç»„åˆæ€§
> - æ¨èä»åº”ç”¨å±‚è§£å†³é˜²æœºå™¨äººé—®é¢˜

---

## ğŸ“š ç›®å½•

1. [ä¸ºä»€ä¹ˆè¦é™åˆ¶è°ƒç”¨è€…ç±»å‹](#1-ä¸ºä»€ä¹ˆè¦é™åˆ¶è°ƒç”¨è€…ç±»å‹)
2. [å¸¸ç”¨æ£€æŸ¥æ–¹æ³•çš„æ¼æ´](#2-å¸¸ç”¨æ£€æŸ¥æ–¹æ³•çš„æ¼æ´)
3. [æ¼æ´æ ¸å¿ƒï¼šåˆçº¦çš„è¯ç”Ÿç¬é—´](#3-æ¼æ´æ ¸å¿ƒåˆçº¦çš„è¯ç”Ÿç¬é—´)
4. [æ”»å‡»æ–¹æ³•](#4-æ”»å‡»æ–¹æ³•)
5. [æ›´å¯é çš„æ£€æŸ¥æ–¹æ³•](#5-æ›´å¯é çš„æ£€æŸ¥æ–¹æ³•)
6. [å®æˆ˜æ¼”ç»ƒ](#6-å®æˆ˜æ¼”ç»ƒ)
7. [æœ€ä½³å®è·µ](#7-æœ€ä½³å®è·µ)

---

## 1. ä¸ºä»€ä¹ˆè¦é™åˆ¶è°ƒç”¨è€…ç±»å‹ï¼Ÿ

### 1.1 å¸¸è§éœ€æ±‚

åœ¨æ·±å…¥æ¼æ´ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦æ˜ç™½å¼€å‘è€…ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§éœ€æ±‚ï¼š

#### é˜²æ­¢æœºå™¨äºº/è„šæœ¬æ»¥ç”¨

åœ¨ä¸€äº›å…¬å¹³å¯åŠ¨çš„é¡¹ç›®ä¸­ï¼Œå¦‚ NFT é“¸é€  (Mint) æˆ–ä»£å¸ç©ºæŠ•ï¼Œé¡¹ç›®æ–¹å¸Œæœ›é™åˆ¶æ¯ä¸ª"äºº"åªèƒ½å‚ä¸ä¸€æ¬¡ã€‚

é€šè¿‡ç¦æ­¢åˆçº¦è°ƒç”¨ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ æœºå™¨äººæ‰¹é‡æ“ä½œçš„éš¾åº¦ã€‚

#### é¿å…å¤æ‚çš„åˆçº¦äº¤äº’

æŸäº›åè®®çš„è®¾è®¡å¯èƒ½æ²¡æœ‰è€ƒè™‘åˆ°è¢«å…¶ä»–åˆçº¦ä»¥å¤æ‚æ–¹å¼ï¼ˆå¦‚åœ¨ä¸€ä¸ªäº¤æ˜“ä¸­å¤šæ¬¡è°ƒç”¨ã€ç»“åˆé—ªç”µè´·ç­‰ï¼‰è¿›è¡Œäº¤äº’çš„æƒ…å†µã€‚

ä¸ºäº†é¿å…ä¸å¯é¢„è§çš„é£é™©ï¼Œå¼€å‘è€…å¯èƒ½ä¼šç®€å•åœ°ç¦æ­¢æ‰€æœ‰æ¥è‡ªåˆçº¦çš„è°ƒç”¨ã€‚

#### ç¡®ä¿æŸäº›æ“ä½œçš„åŸå­æ€§

å¼€å‘è€…å¯èƒ½å‡è®¾è°ƒç”¨è€…æ˜¯ EOAï¼Œä»è€Œè®¤ä¸ºå‡½æ•°è°ƒç”¨æ˜¯åŸå­çš„ï¼Œä¸ä¼šæœ‰é‡å…¥ç­‰é£é™©ï¼ˆè¿™æ˜¯ä¸€ä¸ª**å±é™©çš„å‡è®¾**ï¼‰ã€‚

---

## 2. å¸¸ç”¨æ£€æŸ¥æ–¹æ³•çš„æ¼æ´

### 2.1 EXTCODESIZE æ£€æŸ¥

è¦åˆ¤æ–­ä¸€ä¸ªåœ°å€æ˜¯ EOA è¿˜æ˜¯åˆçº¦è´¦æˆ·ï¼Œæœ€å¸¸ç”¨ã€æœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯æ£€æŸ¥è¯¥åœ°å€ä¸Šæ˜¯å¦å­˜åœ¨ä»£ç ã€‚

ä»¥å¤ªåŠè™šæ‹Ÿæœºï¼ˆEVMï¼‰æä¾›äº†ä¸€ä¸ªæ“ä½œç  `EXTCODESIZE` æ¥è·å–åœ°å€çš„ä»£ç é•¿åº¦ã€‚

| è´¦æˆ·ç±»å‹ | extcodesize | è¯´æ˜ |
|---------|-------------|------|
| **åˆçº¦è´¦æˆ·** | > 0 | æœ‰åˆçº¦ä»£ç  |
| **EOA è´¦æˆ·** | = 0 | æ²¡æœ‰ä»£ç  |

### 2.2 çœ‹ä¼¼å®‰å…¨çš„æ£€æŸ¥

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

contract Target {
    string public message;
    
    // âŒ æœ‰æ¼æ´çš„æ£€æŸ¥ä¿®é¥°ç¬¦
    modifier onlyEOA() {
        // ä½¿ç”¨ assembly è·å–è°ƒç”¨è€…çš„ä»£ç é•¿åº¦
        uint32 size;
        address caller = msg.sender;
        assembly {
            size := extcodesize(caller)
        }
        require(size == 0, "Only EOAs can call this function");
        _;
    }
    
    function sensitiveAction() public onlyEOA {
        message = "Action completed by an EOA";
    }
    
    function getMessage() public view returns (string memory) {
        return message;
    }
}
```

è¿™ä¸ª `onlyEOA` ä¿®é¥°ç¬¦çœ‹èµ·æ¥å¤©è¡£æ— ç¼ï¼šæ£€æŸ¥è°ƒç”¨è€…çš„ä»£ç é•¿åº¦ï¼Œå¦‚æœä¸º0ï¼Œå°±æ”¾è¡Œã€‚

**é‚£ä¹ˆï¼Œæ¼æ´å‡ºåœ¨å“ªé‡Œå‘¢ï¼Ÿ**

---

## 3. æ¼æ´æ ¸å¿ƒï¼šåˆçº¦çš„è¯ç”Ÿç¬é—´

### 3.1 å…³é”®äº‹å®

è¿™ä¸ªæ£€æŸ¥çš„æ¼æ´æºäºä¸€ä¸ªå…³äºåˆçº¦ç”Ÿå‘½å‘¨æœŸçš„å…³é”®äº‹å®ï¼š

**ä¸€ä¸ªæ™ºèƒ½åˆçº¦çš„åœ°å€ä¸Šå‡ºç°ä»£ç ï¼Œæ˜¯åœ¨å®ƒçš„ `constructor` (æ„é€ å‡½æ•°) æ‰§è¡Œå®Œæ¯•ä¹‹åã€‚**

æ¢å¥è¯è¯´ï¼š
- å½“ä¸€ä¸ªåˆçº¦æ­£åœ¨æ‰§è¡Œå…¶ `constructor` é€»è¾‘æ—¶
- å®ƒçš„ `extcodesize` **ä»ç„¶æ˜¯ 0**ï¼
- å®ƒå°±åƒä¸€ä¸ªæ­£åœ¨"è¯ç”Ÿ"ä½†è¿˜æœªå®Œå…¨æˆå½¢çš„ç”Ÿå‘½
- åœ¨EVMçš„è§†è§’é‡Œï¼Œå®ƒæ­¤åˆ»è¿˜æ²¡æœ‰"èº«ä½“"ï¼ˆä»£ç ï¼‰

### 3.2 åˆçº¦éƒ¨ç½²æµç¨‹

```
1. åˆ›å»ºåˆçº¦åœ°å€
   â†“
2. æ‰§è¡Œ constructorï¼ˆæ­¤æ—¶ extcodesize = 0ï¼‰
   â†“
3. å°† runtime code å­˜å‚¨åˆ°åœ°å€ï¼ˆæ­¤æ—¶ extcodesize > 0ï¼‰
   â†“
4. éƒ¨ç½²å®Œæˆ
```

**å…³é”®ç‚¹**ï¼šåœ¨æ­¥éª¤2ï¼Œåˆçº¦åœ°å€çš„ `extcodesize` ä»ç„¶æ˜¯ 0ï¼

---

## 4. æ”»å‡»æ–¹æ³•

### 4.1 æ”»å‡»åˆçº¦

æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œç¼–å†™ä¸€ä¸ª**æ”»å‡»åˆçº¦**ï¼Œå°†æ¶æ„çš„è°ƒç”¨é€»è¾‘æ”¾åœ¨ `constructor` é‡Œé¢ã€‚

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.26;

interface ITarget {
    function sensitiveAction() external;
}

contract Attacker {
    string public result;
    
    // ğŸ’£ æ„é€ å‡½æ•°ï¼šåœ¨éƒ¨ç½²æœ¬åˆçº¦çš„ç¬é—´è¢«æ‰§è¡Œ
    constructor(address targetAddress) {
        ITarget target = ITarget(targetAddress);
        
        // **å…³é”®æ”»å‡»ç‚¹**
        // åœ¨ Attacker åˆçº¦çš„æ„é€ å‡½æ•°æ‰§è¡ŒæœŸé—´ï¼Œ
        // Attacker åœ°å€çš„ extcodesize ä»ç„¶æ˜¯ 0ã€‚
        // å› æ­¤ï¼Œå¯¹ Target.sensitiveAction() çš„è°ƒç”¨ä¼šæˆåŠŸç»•è¿‡ onlyEOA æ£€æŸ¥ï¼
        target.sensitiveAction();
        
        result = "Attack successful!";
    }
}
```

### 4.2 æ”»å‡»æµç¨‹

1. `Target` åˆçº¦å·²ç»éƒ¨ç½²åœ¨é“¾ä¸Š
2. æ”»å‡»è€…éƒ¨ç½² `Attacker` åˆçº¦ï¼Œå¹¶å°† `Target` åˆçº¦çš„åœ°å€ä½œä¸ºå‚æ•°ä¼ å…¥ `Attacker` çš„æ„é€ å‡½æ•°
3. åœ¨éƒ¨ç½² `Attacker` åˆçº¦çš„è¿™ç¬”äº¤æ˜“ä¸­ï¼Œ`Attacker` çš„æ„é€ å‡½æ•°è¢«æ‰§è¡Œ
4. æ„é€ å‡½æ•°å†…éƒ¨è°ƒç”¨äº† `Target.sensitiveAction()`
5. `Target` åˆçº¦çš„ `onlyEOA` ä¿®é¥°ç¬¦å¼€å§‹æ£€æŸ¥ `msg.sender`ï¼ˆä¹Ÿå°±æ˜¯ `Attacker` åˆçº¦çš„åœ°å€ï¼‰çš„ä»£ç é•¿åº¦
6. **ç”±äº `Attacker` åˆçº¦è¿˜åœ¨æ„é€ è¿‡ç¨‹ä¸­ï¼Œ`extcodesize(address(Attacker))` è¿”å› `0`ï¼**
7. `require(size == 0)` çš„æ£€æŸ¥é€šè¿‡ï¼Œ`sensitiveAction()` è¢«ä¸€ä¸ª**åˆçº¦è´¦æˆ·**æˆåŠŸè°ƒç”¨
8. æ£€æŸ¥è¢«å®Œç¾ç»•è¿‡ï¼

### 4.3 æ—¶åºå›¾

```
æ”»å‡»è€…éƒ¨ç½² Attacker(Targetåœ°å€)
    â†“
Attacker.constructor å¼€å§‹æ‰§è¡Œ
    â†“
extcodesize(Attacker) = 0  â† å…³é”®ç‚¹ï¼
    â†“
è°ƒç”¨ Target.sensitiveAction()
    â†“
Target æ£€æŸ¥ extcodesize(msg.sender)
    â†“
æ£€æŸ¥ç»“æœï¼š0  â† ç»•è¿‡æˆåŠŸï¼
    â†“
sensitiveAction() æ‰§è¡Œ
    â†“
Attacker.constructor å®Œæˆ
    â†“
extcodesize(Attacker) > 0ï¼ˆç°åœ¨æ‰æœ‰ä»£ç ï¼‰
```

---

## 5. æ›´å¯é çš„æ£€æŸ¥æ–¹æ³•

æ—¢ç„¶ `extcodesize` ä¸å¯é ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠï¼Ÿ

### 5.1 æ–¹æ³•ä¸€ï¼šæ£€æŸ¥ tx.origin (æœ‰äº‰è®®)

ä¸€ä¸ªæ›´ä¸¥æ ¼çš„æ£€æŸ¥æ–¹å¼æ˜¯åˆ¤æ–­**äº¤æ˜“çš„å‘èµ·è€… (`tx.origin`)** å’Œ **ç›´æ¥è°ƒç”¨è€… (`msg.sender`)** æ˜¯å¦ä¸ºåŒä¸€ä¸ªåœ°å€ã€‚

```solidity
modifier trulyOnlyEOA() {
    // æ£€æŸ¥ç›´æ¥è°ƒç”¨è€…å’Œäº¤æ˜“å‘èµ·è€…æ˜¯å¦æ˜¯åŒä¸€ä¸ªåœ°å€
    require(msg.sender == tx.origin, "Only EOAs can call this function");
    _;
}
```

#### åŸç†

- `tx.origin`ï¼šæ°¸è¿œæ˜¯å‘èµ·è¿™ç¬”äº¤æ˜“çš„ EOA è´¦æˆ·
- `msg.sender`ï¼šæ˜¯ç›´æ¥ä¸æœ¬åˆçº¦äº¤äº’çš„åœ°å€

å¦‚æœä¸€ä¸ªåˆçº¦Aè°ƒç”¨å¦ä¸€ä¸ªåˆçº¦Bï¼Œé‚£ä¹ˆå¯¹äºBæ¥è¯´ï¼š
- `msg.sender` æ˜¯åˆçº¦Açš„åœ°å€
- `tx.origin` æ˜¯æœ€åˆå‘èµ·è¿™ç¬”äº¤æ˜“çš„ç”¨æˆ·é’±åŒ…åœ°å€

#### âœ… ä¼˜ç‚¹

è¿™ä¸ªæ£€æŸ¥å¯ä»¥æœ‰æ•ˆåœ°é˜»æ­¢æ‰€æœ‰æ¥è‡ªå…¶ä»–åˆçº¦çš„è°ƒç”¨ï¼ˆåŒ…æ‹¬åœ¨æ„é€ å‡½æ•°ä¸­çš„è°ƒç”¨ï¼‰ã€‚

#### âŒ å·¨å¤§ç¼ºç‚¹ï¼ˆä¸ºä»€ä¹ˆä¸æ¨èï¼‰

1. **ç ´åäº†åˆçº¦çš„å¯ç»„åˆæ€§**
   - æ™ºèƒ½åˆçº¦çš„é­…åŠ›åœ¨äºå¯ä»¥åƒä¹é«˜ä¸€æ ·äº’ç›¸ç»„åˆ
   - è¿™ä¸ªæ£€æŸ¥ä¼šé˜»æ­¢æ‰€æœ‰åˆæ³•çš„åˆçº¦é—´è°ƒç”¨

2. **ä¸æ™ºèƒ½åˆçº¦é’±åŒ…ä¸å…¼å®¹**
   - åƒ Gnosis Safe, Argent è¿™æ ·çš„å¤šç­¾é’±åŒ…å’Œè´¦æˆ·æŠ½è±¡é’±åŒ…ï¼Œå…¶æœ¬èº«å°±æ˜¯æ™ºèƒ½åˆçº¦
   - ä½¿ç”¨è¿™ä¸ªæ£€æŸ¥ï¼Œä¼šå¯¼è‡´è¿™äº›é«˜çº§é’±åŒ…çš„ç”¨æˆ·å®Œå…¨æ— æ³•ä¸ä½ çš„åè®®äº¤äº’
   - è¿™åœ¨æœªæ¥çš„ä»¥å¤ªåŠç”Ÿæ€ä¸­æ˜¯**è‡´å‘½çš„**

### 5.2 æ–¹æ³•äºŒï¼šæ”¹å˜è®¾è®¡æ€è·¯ï¼ˆæ¨èï¼‰

ä¸å…¶è¯•å›¾åœ¨æŠ€æœ¯ä¸ŠåŒºåˆ† EOA å’Œåˆçº¦ï¼Œä¸å¦‚ä»åº”ç”¨é€»è¾‘å’Œç»æµæ¨¡å‹ä¸Šè§£å†³æ ¹æœ¬é—®é¢˜ã€‚

#### å¯¹äºé˜²æœºå™¨äºº

ä¸è¦ä¾èµ–é“¾ä¸Šæ£€æŸ¥ã€‚é‡‡ç”¨ï¼š
- **ç™½åå• (Whitelist)**
- **éªŒè¯ç  (Captcha)**
- **ç­¾åè´¨è¯¢**
- ç­‰é“¾ä¸‹æˆ–åŠé“¾ä¸‹æ–¹æ¡ˆæ¥éªŒè¯ç”¨æˆ·èº«ä»½

æˆ–è€…è®¾è®¡æ›´å¥½çš„ç»æµæ¨¡å‹ï¼š
- **è·å…°å¼æ‹å–**
- è®©æœºå™¨äººæ²¡æœ‰å¥—åˆ©ç©ºé—´

#### å¯¹äºé˜²å¤æ‚äº¤äº’

ä¸è¦ä¸€åˆ€åˆ‡åœ°ç¦æ­¢åˆçº¦ã€‚åº”è¯¥å‡è®¾ä½ çš„åˆçº¦ä¸€å®šä¼šè¢«å…¶ä»–åˆçº¦è°ƒç”¨ï¼Œå¹¶ä¸ºæ­¤åšå¥½å‡†å¤‡ï¼š
- ä½¿ç”¨**é‡å…¥é” (`ReentrancyGuard`)** æ¥é˜²æ­¢é‡å…¥æ”»å‡»
- ä»”ç»†è®¾è®¡åè®®çš„é€»è¾‘ä»¥æŠµå¾¡é—ªç”µè´·ç­‰

---

## 6. å®æˆ˜æ¼”ç»ƒ

### 6.1 Remix ç»ƒä¹ 

**æ­¥éª¤ 1ï¼šéƒ¨ç½²ç›®æ ‡åˆçº¦**
1. éƒ¨ç½² `Target` åˆçº¦
2. ç”¨ EOA è°ƒç”¨ `sensitiveAction()` - æˆåŠŸ âœ…
3. è§‚å¯Ÿ `message` è¢«è®¾ç½®

**æ­¥éª¤ 2ï¼šå°è¯•åˆçº¦è°ƒç”¨ï¼ˆå¤±è´¥ï¼‰**
1. åˆ›å»ºä¸€ä¸ªæ™®é€šåˆçº¦å°è¯•è°ƒç”¨ - å¤±è´¥ âŒ
2. å› ä¸º `extcodesize` > 0

**æ­¥éª¤ 3ï¼šç»•è¿‡æ”»å‡»**
1. éƒ¨ç½² `Attacker` åˆçº¦ï¼Œä¼ å…¥ `Target` åœ°å€
2. è§‚å¯Ÿ `Attacker` éƒ¨ç½²æˆåŠŸ
3. æ£€æŸ¥ `Target.message` - å·²è¢«ä¿®æ”¹ï¼
4. æ”»å‡»æˆåŠŸç»•è¿‡äº† `onlyEOA` æ£€æŸ¥

---

## 7. æœ€ä½³å®è·µ

### 7.1 é—®é¢˜å¯¹æ¯”è¡¨

| æ–¹é¢ | æè¿° |
|------|------|
| **é—®é¢˜** | å¦‚ä½•é™åˆ¶å‡½æ•°åªèƒ½è¢« EOA è°ƒç”¨ï¼Œè€Œä¸èƒ½è¢«åˆçº¦è°ƒç”¨ |
| **æœ‰æ¼æ´çš„æ£€æŸ¥** | `require(extcodesize(msg.sender) == 0)` |
| **ç»•è¿‡æ–¹æ³•** | æ”»å‡»è€…åœ¨è‡ªå·±çš„åˆçº¦çš„ `constructor` ä¸­è°ƒç”¨ç›®æ ‡å‡½æ•° |
| **æœ‰äº‰è®®çš„ä¿®å¤** | `require(msg.sender == tx.origin)` - æœ‰æ•ˆï¼Œä½†ç ´åå¯ç»„åˆæ€§ |
| **æ¨èçš„è§£å†³æ–¹æ¡ˆ** | æ”¾å¼ƒåœ¨é“¾ä¸ŠåŒºåˆ† EOA å’Œåˆçº¦ï¼Œé‡‡ç”¨åº”ç”¨å±‚è®¾è®¡ |

### 7.2 æ¨èæ–¹æ¡ˆ

#### âœ… ç™½åå• + ç­¾å

```solidity
contract SecureNFTMint {
    mapping(address => bool) public hasMinted;
    address public signer;
    
    function mint(bytes calldata signature) public {
        require(!hasMinted[msg.sender], "Already minted");
        
        // éªŒè¯ç­¾åï¼ˆé“¾ä¸‹ç­¾å‘ï¼‰
        bytes32 message = keccak256(abi.encodePacked(msg.sender));
        bytes32 ethSignedMessage = keccak256(abi.encodePacked(
            "\x19Ethereum Signed Message:\n32",
            message
        ));
        
        address recovered = recoverSigner(ethSignedMessage, signature);
        require(recovered == signer, "Invalid signature");
        
        hasMinted[msg.sender] = true;
        // mint NFT
    }
    
    function recoverSigner(bytes32 message, bytes memory sig) 
        internal pure returns (address) 
    {
        // ECDSA recovery logic
    }
}
```

#### âœ… è·å…°å¼æ‹å–

```solidity
contract DutchAuctionNFT {
    uint256 public startPrice = 10 ether;
    uint256 public startTime;
    
    function getCurrentPrice() public view returns (uint256) {
        uint256 elapsed = block.timestamp - startTime;
        uint256 discount = elapsed * 0.1 ether;
        
        if (discount >= startPrice) {
            return 0.1 ether;
        }
        
        return startPrice - discount;
    }
    
    function mint() public payable {
        uint256 price = getCurrentPrice();
        require(msg.value >= price, "Insufficient payment");
        
        // æœºå™¨äººæ²¡æœ‰å¥—åˆ©ç©ºé—´
        // mint NFT
    }
}
```

### 7.3 ä»£ç æ£€æŸ¥æ¸…å•

- [ ] ä¸ä½¿ç”¨ `extcodesize` æ£€æŸ¥ EOA
- [ ] ä¸ä½¿ç”¨ `tx.origin` åšæƒé™éªŒè¯
- [ ] ä½¿ç”¨ç™½åå• + ç­¾åéªŒè¯
- [ ] æˆ–ä½¿ç”¨ç»æµæ¨¡å‹ï¼ˆè·å…°æ‹å–ç­‰ï¼‰
- [ ] å‡è®¾åˆçº¦ä¼šè¢«å…¶ä»–åˆçº¦è°ƒç”¨
- [ ] ä½¿ç”¨ ReentrancyGuard é˜²é‡å…¥

---

## ğŸ“š å­¦ä¹ èµ„æº

### æ–‡ç« 
- [EVM Deep Dives: The Path to Shadowy Super Coder](https://noxx.substack.com/p/evm-deep-dives-the-path-to-shadowy)
- [Contract Size Check Bypass](https://medium.com/coinmonks/ethernaut-lvl-14-gatekeeper-two-walkthrough-how-extcodesize-may-be-manipulated-14f1f1cfb45)

### çœŸå®æ¡ˆä¾‹
- [OpenSea Contract Check Issues](https://github.com/ProjectOpenSea/seaport)

---

## âœ… å­¦ä¹ æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬ç« èŠ‚åï¼Œç¡®è®¤ä½ å·²ç»ï¼š

- [ ] ç†è§£äº† `extcodesize` çš„å±€é™æ€§
- [ ] çŸ¥é“åˆçº¦åœ¨æ„é€ æœŸé—´ä»£ç é•¿åº¦ä¸º 0
- [ ] åœ¨ Remix ä¸­å¤ç°äº†ç»•è¿‡æ”»å‡»
- [ ] ç†è§£äº† `tx.origin` çš„ç¼ºç‚¹
- [ ] çŸ¥é“æ¨èçš„é˜²æœºå™¨äººæ–¹æ¡ˆ
- [ ] ç†è§£äº†åˆçº¦å¯ç»„åˆæ€§çš„é‡è¦æ€§

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. âœ… åœ¨ Remix ä¸­å®è·µç»•è¿‡æ”»å‡»
2. âœ… å®ç°ç™½åå• + ç­¾åéªŒè¯ç³»ç»Ÿ
3. âœ… ç»§ç»­å­¦ä¹ é«˜çº§å®‰å…¨æ¼æ´
4. âœ… æ›´æ–°ä½ çš„ `PROGRESS.md`

---

**è®°ä½**ï¼š
- âŒ **ä¸è¦ç”¨ extcodesize åˆ¤æ–­ EOA**
- âŒ **ä¸è¦ç”¨ tx.origin åšæƒé™éªŒè¯**
- âœ… **ä»åº”ç”¨å±‚è§£å†³é˜²æœºå™¨äººé—®é¢˜**
- ğŸ”— **ä¿æŒåˆçº¦çš„å¯ç»„åˆæ€§**

ç¥ä½ å­¦ä¹ é¡ºåˆ©ï¼ğŸš€

